{"version":3,"sources":["file:////Users/yangjiang/dev/learn/vue/src/watcher.js","file:///webpack/runtime/getFullHash"],"names":["uid","Watcher","vm","expOrFn","cb","options","extend","isFn","_watchers","push","expression","id","active","dirty","lazy","deps","newDeps","depIds","Set","newDepIds","prevError","getter","setter","undefined","res","parseExpression","twoWay","get","set","value","queued","shallow","prototype","beforeGet","scope","call","e","process","config","warn","toString","deep","traverse","preProcess","filters","_applyFilters","postProcess","afterGet","forContext","$forContext","alias","_withLock","$key","rawValue","$set","$index","Dep","addDep","dep","has","add","addSub","console","log","i","length","removeSub","tmp","clear","update","sync","run","Error","pushWatcher","isObject","oldValue","nextTick","evaluate","current","depend","teardown","_isBeingDestroyed","_vForRemoving","$remove","seenObjects","val","seen","keys","isA","isArray","isO","Object","isExtensible","__ob__","depId"],"mappings":"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","file":"main.211058d2c24cf398558d.hot-update.js","sourcesContent":["import config from \"./config\";\nimport Dep from \"./observer/dep\";\nimport { parseExpression } from \"./parsers/expression\";\nimport { pushWatcher } from \"./batcher\";\nimport {\n  extend,\n  warn,\n  isArray,\n  isObject,\n  nextTick,\n  _Set as Set,\n} from \"./util/index\";\n\nlet uid = 0;\n\n/**\n * A watcher parses an expression, collects dependencies,\n * and fires callback when the expression value changes.\n * This is used for both the $watch() api and directives.\n *\n * @param {Vue} vm\n * @param {String|Function} expOrFn\n * @param {Function} cb\n * @param {Object} options\n *                 - {Array} filters\n *                 - {Boolean} twoWay\n *                 - {Boolean} deep\n *                 - {Boolean} user\n *                 - {Boolean} sync\n *                 - {Boolean} lazy\n *                 - {Function} [preProcess]\n *                 - {Function} [postProcess]\n * @constructor\n */\n\nexport default function Watcher(vm, expOrFn, cb, options) {\n  // mix in options\n  if (options) {\n    extend(this, options);\n  }\n  var isFn = typeof expOrFn === \"function\";\n  this.vm = vm;\n  vm._watchers.push(this);\n  this.expression = expOrFn;\n  this.cb = cb;\n  this.id = ++uid; // uid for batching\n  this.active = true;\n  this.dirty = this.lazy; // for lazy watchers\n  this.deps = [];\n  this.newDeps = [];\n  this.depIds = new Set();\n  this.newDepIds = new Set();\n  this.prevError = null; // for async error stacks\n  // parse expression for getter/setter\n  if (isFn) {\n    this.getter = expOrFn;\n    this.setter = undefined;\n  } else {\n    var res = parseExpression(expOrFn, this.twoWay);\n    this.getter = res.get;\n    this.setter = res.set;\n  }\n  this.value = this.lazy ? undefined : this.get();\n  // state for avoiding false triggers for deep and Array\n  // watchers during vm._digest()\n  this.queued = this.shallow = false;\n}\n\n/**\n * Evaluate the getter, and re-collect dependencies.\n */\n\nWatcher.prototype.get = function () {\n  this.beforeGet();\n  var scope = this.scope || this.vm;\n  var value;\n  try {\n    value = this.getter.call(scope, scope);\n  } catch (e) {\n    if (process.env.NODE_ENV !== \"production\" && config.warnExpressionErrors) {\n      warn(\n        \"Error when evaluating expression \" +\n          '\"' +\n          this.expression +\n          '\": ' +\n          e.toString(),\n        this.vm\n      );\n    }\n  }\n  // \"touch\" every property so they are all tracked as\n  // dependencies for deep watching\n  if (this.deep) {\n    traverse(value);\n  }\n  if (this.preProcess) {\n    value = this.preProcess(value);\n  }\n  if (this.filters) {\n    value = scope._applyFilters(value, null, this.filters, false);\n  }\n  if (this.postProcess) {\n    value = this.postProcess(value);\n  }\n  this.afterGet();\n  return value;\n};\n\n/**\n * Set the corresponding value with the setter.\n *\n * @param {*} value\n */\n\nWatcher.prototype.set = function (value) {\n  var scope = this.scope || this.vm;\n  if (this.filters) {\n    value = scope._applyFilters(value, this.value, this.filters, true);\n  }\n  try {\n    this.setter.call(scope, scope, value);\n  } catch (e) {\n    if (process.env.NODE_ENV !== \"production\" && config.warnExpressionErrors) {\n      warn(\n        \"Error when evaluating setter \" +\n          '\"' +\n          this.expression +\n          '\": ' +\n          e.toString(),\n        this.vm\n      );\n    }\n  }\n  // two-way sync for v-for alias\n  var forContext = scope.$forContext;\n  if (forContext && forContext.alias === this.expression) {\n    if (forContext.filters) {\n      process.env.NODE_ENV !== \"production\" &&\n        warn(\n          \"It seems you are using two-way binding on \" +\n            \"a v-for alias (\" +\n            this.expression +\n            \"), and the \" +\n            \"v-for has filters. This will not work properly. \" +\n            \"Either remove the filters or use an array of \" +\n            \"objects and bind to object properties instead.\",\n          this.vm\n        );\n      return;\n    }\n    forContext._withLock(function () {\n      if (scope.$key) {\n        // original is an object\n        forContext.rawValue[scope.$key] = value;\n      } else {\n        forContext.rawValue.$set(scope.$index, value);\n      }\n    });\n  }\n};\n\n/**\n * Prepare for dependency collection.\n */\n\nWatcher.prototype.beforeGet = function () {\n  Dep.target = this;\n};\n\n/**\n * Add a dependency to this directive.\n *\n * @param {Dep} dep\n */\n\nWatcher.prototype.addDep = function (dep) {\n  var id = dep.id;\n  if (!this.newDepIds.has(id)) {\n    this.newDepIds.add(id);\n    this.newDeps.push(dep);\n    if (!this.depIds.has(id)) {\n      dep.addSub(this);\n    }\n  }\n  console.log(this.deps);\n};\n\n/**\n * Clean up for dependency collection.\n */\n\nWatcher.prototype.afterGet = function () {\n  Dep.target = null;\n  var i = this.deps.length;\n  while (i--) {\n    var dep = this.deps[i];\n    if (!this.newDepIds.has(dep.id)) {\n      dep.removeSub(this);\n    }\n  }\n  var tmp = this.depIds;\n  this.depIds = this.newDepIds;\n  this.newDepIds = tmp;\n  this.newDepIds.clear();\n  tmp = this.deps;\n  this.deps = this.newDeps;\n  this.newDeps = tmp;\n  this.newDeps.length = 0;\n};\n\n/**\n * Subscriber interface.\n * Will be called when a dependency changes.\n *\n * @param {Boolean} shallow\n */\n\nWatcher.prototype.update = function (shallow) {\n  if (this.lazy) {\n    this.dirty = true;\n  } else if (this.sync || !config.async) {\n    this.run();\n  } else {\n    // if queued, only overwrite shallow with non-shallow,\n    // but not the other way around.\n    this.shallow = this.queued ? (shallow ? this.shallow : false) : !!shallow;\n    this.queued = true;\n    // record before-push error stack in debug mode\n    /* istanbul ignore if */\n    if (process.env.NODE_ENV !== \"production\" && config.debug) {\n      this.prevError = new Error(\"[vue] async stack trace\");\n    }\n    pushWatcher(this);\n  }\n};\n\n/**\n * Batcher job interface.\n * Will be called by the batcher.\n */\n\nWatcher.prototype.run = function () {\n  if (this.active) {\n    var value = this.get();\n    if (\n      value !== this.value ||\n      // Deep watchers and watchers on Object/Arrays should fire even\n      // when the value is the same, because the value may\n      // have mutated; but only do so if this is a\n      // non-shallow update (caused by a vm digest).\n      ((isObject(value) || this.deep) && !this.shallow)\n    ) {\n      // set new value\n      var oldValue = this.value;\n      this.value = value;\n      // in debug + async mode, when a watcher callbacks\n      // throws, we also throw the saved before-push error\n      // so the full cross-tick stack trace is available.\n      var prevError = this.prevError;\n      /* istanbul ignore if */\n      if (process.env.NODE_ENV !== \"production\" && config.debug && prevError) {\n        this.prevError = null;\n        try {\n          this.cb.call(this.vm, value, oldValue);\n        } catch (e) {\n          nextTick(function () {\n            throw prevError;\n          }, 0);\n          throw e;\n        }\n      } else {\n        this.cb.call(this.vm, value, oldValue);\n      }\n    }\n    this.queued = this.shallow = false;\n  }\n};\n\n/**\n * Evaluate the value of the watcher.\n * This only gets called for lazy watchers.\n */\n\nWatcher.prototype.evaluate = function () {\n  // avoid overwriting another watcher that is being\n  // collected.\n  var current = Dep.target;\n  this.value = this.get();\n  this.dirty = false;\n  Dep.target = current;\n};\n\n/**\n * Depend on all deps collected by this watcher.\n */\n\nWatcher.prototype.depend = function () {\n  var i = this.deps.length;\n  while (i--) {\n    this.deps[i].depend();\n  }\n};\n\n/**\n * Remove self from all dependencies' subcriber list.\n */\n\nWatcher.prototype.teardown = function () {\n  if (this.active) {\n    // remove self from vm's watcher list\n    // this is a somewhat expensive operation so we skip it\n    // if the vm is being destroyed or is performing a v-for\n    // re-render (the watcher list is then filtered by v-for).\n    if (!this.vm._isBeingDestroyed && !this.vm._vForRemoving) {\n      this.vm._watchers.$remove(this);\n    }\n    var i = this.deps.length;\n    while (i--) {\n      this.deps[i].removeSub(this);\n    }\n    this.active = false;\n    this.vm = this.cb = this.value = null;\n  }\n};\n\n/**\n * Recrusively traverse an object to evoke all converted\n * getters, so that every nested property inside the object\n * is collected as a \"deep\" dependency.\n *\n * @param {*} val\n */\n\nconst seenObjects = new Set();\nfunction traverse(val, seen) {\n  let i, keys;\n  if (!seen) {\n    seen = seenObjects;\n    seen.clear();\n  }\n  const isA = isArray(val);\n  const isO = isObject(val);\n  if ((isA || isO) && Object.isExtensible(val)) {\n    if (val.__ob__) {\n      var depId = val.__ob__.dep.id;\n      if (seen.has(depId)) {\n        return;\n      } else {\n        seen.add(depId);\n      }\n    }\n    if (isA) {\n      i = val.length;\n      while (i--) traverse(val[i], seen);\n    } else if (isO) {\n      keys = Object.keys(val);\n      i = keys.length;\n      while (i--) traverse(val[keys[i]], seen);\n    }\n  }\n}\n","__webpack_require__.h = () => \"dff240b48450cc80fb5a\""],"sourceRoot":""}
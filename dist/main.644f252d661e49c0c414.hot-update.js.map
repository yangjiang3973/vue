{"version":3,"sources":["file:////Users/yangjiang/dev/learn/vue/src/directives/component.js","file:///webpack/runtime/getFullHash"],"names":["_","require","templateParser","module","exports","isLiteral","bind","el","__vue__","ref","document","createComment","replace","keepAlive","_checkParam","refID","attr","cache","template","extractContent","_isDynamicLiteral","resolveCtor","expression","child","build","$before","setCurrent","readyEvent","transMode","warn","id","ctorId","Ctor","vm","$options","components","assertAsset","cached","clone","$addChild","_asComponent","_host","unbuild","childVM","$destroy","remove","cb","$remove","_cleanup","update","value","unsetCurrent","newComponent","self","$once","swapTo","target","current","_refID","$","unbind","key"],"mappings":"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","file":"main.644f252d661e49c0c414.hot-update.js","sourcesContent":["var _ = require('../util');\nvar templateParser = require('../parsers/template');\n\nmodule.exports = {\n    isLiteral: true,\n\n    /**\n     * Setup. Two possible usages:\n     *\n     * - static:\n     *   v-component=\"comp\"\n     *\n     * - dynamic:\n     *   v-component=\"{{currentView}}\"\n     */\n\n    bind: function () {\n        if (!this.el.__vue__) {\n            // create a ref anchor\n            this.ref = document.createComment('v-component');\n            _.replace(this.el, this.ref);\n            // check keep-alive options.\n            // If yes, instead of destroying the active vm when\n            // hiding (v-if) or switching (dynamic literal) it,\n            // we simply remove it from the DOM and save it in a\n            // cache object, with its constructor id as the key.\n            this.keepAlive = this._checkParam('keep-alive') != null;\n            // check ref\n            this.refID = _.attr(this.el, 'ref');\n            if (this.keepAlive) {\n                this.cache = {};\n            }\n            // check inline-template\n            if (this._checkParam('inline-template') !== null) {\n                // extract inline template as a DocumentFragment\n                this.template = _.extractContent(this.el, true);\n            }\n            // if static, build right now.\n            if (!this._isDynamicLiteral) {\n                this.resolveCtor(this.expression);\n                var child = this.build(); //* instantiate Sub\n                child.$before(this.ref);\n                this.setCurrent(child);\n            } else {\n                // check dynamic component params\n                this.readyEvent = this._checkParam('wait-for');\n                this.transMode = this._checkParam('transition-mode');\n            }\n        } else {\n            _.warn(\n                'v-component=\"' +\n                    this.expression +\n                    '\" cannot be ' +\n                    'used on an already mounted instance.'\n            );\n        }\n    },\n\n    /**\n     * Resolve the component constructor to use when creating\n     * the child vm.\n     */\n\n    resolveCtor: function (id) {\n        this.ctorId = id;\n        this.Ctor = this.vm.$options.components[id];\n        _.assertAsset(this.Ctor, 'component', id);\n    },\n\n    /**\n     * Instantiate/insert a new child vm.\n     * If keep alive and has cached instance, insert that\n     * instance; otherwise build a new one and cache it.\n     *\n     * @return {Vue} - the created instance\n     */\n\n    build: function () {\n        if (this.keepAlive) {\n            var cached = this.cache[this.ctorId];\n            if (cached) {\n                return cached;\n            }\n        }\n        var vm = this.vm;\n        var el = templateParser.clone(this.el);\n        if (this.Ctor) {\n            var child = vm.$addChild(\n                {\n                    el: el,\n                    template: this.template,\n                    _asComponent: true,\n                    _host: this._host,\n                },\n                this.Ctor\n            );\n            if (this.keepAlive) {\n                this.cache[this.ctorId] = child;\n            }\n            return child;\n        }\n    },\n\n    /**\n     * Teardown the current child, but defers cleanup so\n     * that we can separate the destroy and removal steps.\n     */\n\n    unbuild: function () {\n        var child = this.childVM;\n        if (!child || this.keepAlive) {\n            return;\n        }\n        // the sole purpose of `deferCleanup` is so that we can\n        // \"deactivate\" the vm right now and perform DOM removal\n        // later.\n        child.$destroy(false, true);\n    },\n\n    /**\n     * Remove current destroyed child and manually do\n     * the cleanup after removal.\n     *\n     * @param {Function} cb\n     */\n\n    remove: function (child, cb) {\n        var keepAlive = this.keepAlive;\n        if (child) {\n            child.$remove(function () {\n                if (!keepAlive) child._cleanup();\n                if (cb) cb();\n            });\n        } else if (cb) {\n            cb();\n        }\n    },\n\n    /**\n     * Update callback for the dynamic literal scenario,\n     * e.g. v-component=\"{{view}}\"\n     */\n\n    update: function (value) {\n        if (!value) {\n            // just destroy and remove current\n            this.unbuild();\n            this.remove(this.childVM);\n            this.unsetCurrent();\n        } else {\n            this.resolveCtor(value);\n            this.unbuild();\n            var newComponent = this.build();\n            var self = this;\n            if (this.readyEvent) {\n                newComponent.$once(this.readyEvent, function () {\n                    self.swapTo(newComponent);\n                });\n            } else {\n                this.swapTo(newComponent);\n            }\n        }\n    },\n\n    /**\n     * Actually swap the components, depending on the\n     * transition mode. Defaults to simultaneous.\n     *\n     * @param {Vue} target\n     */\n\n    swapTo: function (target) {\n        var self = this;\n        var current = this.childVM;\n        this.unsetCurrent();\n        this.setCurrent(target);\n        switch (self.transMode) {\n            case 'in-out':\n                target.$before(self.ref, function () {\n                    self.remove(current);\n                });\n                break;\n            case 'out-in':\n                self.remove(current, function () {\n                    target.$before(self.ref);\n                });\n                break;\n            default:\n                self.remove(current);\n                target.$before(self.ref);\n        }\n    },\n\n    /**\n     * Set childVM and parent ref\n     */\n\n    setCurrent: function (child) {\n        this.childVM = child;\n        var refID = child._refID || this.refID;\n        if (refID) {\n            this.vm.$[refID] = child;\n        }\n    },\n\n    /**\n     * Unset childVM and parent ref\n     */\n\n    unsetCurrent: function () {\n        var child = this.childVM;\n        this.childVM = null;\n        var refID = (child && child._refID) || this.refID;\n        if (refID) {\n            this.vm.$[refID] = null;\n        }\n    },\n\n    /**\n     * Unbind.\n     */\n\n    unbind: function () {\n        this.unbuild();\n        // destroy all keep-alive cached instances\n        if (this.cache) {\n            for (var key in this.cache) {\n                this.cache[key].$destroy();\n            }\n            this.cache = null;\n        }\n    },\n};\n","__webpack_require__.h = () => \"496b1c33d6c200e70930\""],"sourceRoot":""}